<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë™í™”ì±…</title>
  <style>
    /* Body ìŠ¤íƒ€ì¼: ì „ì²´ í˜ì´ì§€ ì„¤ì • */
    body {
      margin: 0; /* ê¸°ë³¸ ì—¬ë°± ì œê±° */
      padding: 0; /* ê¸°ë³¸ íŒ¨ë”© ì œê±° */
      font-family: 'Arial', sans-serif; /* ê¸°ë³¸ í°íŠ¸ ì„¤ì • */
      background-color: #f9f5ec; /* ë°°ê²½ ìƒ‰ìƒ */
      display: flex; /* í˜ì´ì§€ ì „ì²´ë¥¼ Flexboxë¡œ ì •ë ¬ */
      justify-content: center; /* ìˆ˜í‰ ì¤‘ì•™ ì •ë ¬ */
      align-items: center; /* ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬ */
      height: 100vh; /* í™”ë©´ ì „ì²´ ë†’ì´ */
      user-select: none; /* í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ */
    }

    /* ì±… ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
    .book {
      position: relative; /* ë‚´ë¶€ ìš”ì†Œì˜ ì ˆëŒ€ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„¤ì • */
      width: 80%; /* ì±… ì „ì²´ ë„ˆë¹„ */
      height: 60%; /* ì±… ì „ì²´ ë†’ì´ */
      display: flex; /* ë‚´ë¶€ ìš”ì†Œë¥¼ ê°€ë¡œë¡œ ì •ë ¬ */
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3); /* ê·¸ë¦¼ì íš¨ê³¼ */
      background: linear-gradient(135deg, #f9f5ec 49.9%, #d9d9d9 50%); /* ì±…ì˜ ì–‘ìª½ ìƒ‰ìƒ êµ¬ë¶„ */
      border-radius: 20px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
      overflow: hidden; /* ì±…ì„ ë²—ì–´ë‚œ ì½˜í…ì¸  ìˆ¨ê¹€ */
    }

    /* í˜ì´ì§€ ì»¨í…Œì´ë„ˆ: ì™¼ìª½/ì˜¤ë¥¸ìª½ í˜ì´ì§€ */
    .page {
      display: flex; /* ë‚´ë¶€ ìš”ì†Œë¥¼ Flexboxë¡œ ì •ë ¬ */
      height: 100%; /* ì±…ì˜ ì „ì²´ ë†’ì´ */
      flex-grow: 1; /* ë„ˆë¹„ë¥¼ ìë™ìœ¼ë¡œ ì¡°ì • */
      overflow: hidden; /* ë„˜ì¹˜ëŠ” ì½˜í…ì¸  ìˆ¨ê¹€ */
    }

    /* ì™¼ìª½ í˜ì´ì§€ (ì´ë¯¸ì§€ í‘œì‹œ ì˜ì—­) */
    .left-page {
      display: flex; /* ì´ë¯¸ì§€ ê°€ìš´ë° ì •ë ¬ */
      justify-content: center; /* ìˆ˜í‰ ì¤‘ì•™ ì •ë ¬ */
      align-items: center; /* ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬ */
      background: #eef2ff; /* í˜ì´ì§€ ë°°ê²½ ìƒ‰ìƒ */
      width: 100%; /* ì´ˆê¸° ë„ˆë¹„ */
    }

    /* ì™¼ìª½ í˜ì´ì§€ ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
    .left-page img {
      width: 100%; /* ì´ë¯¸ì§€ê°€ í˜ì´ì§€ì— ë§ë„ë¡ ì„¤ì • */
      height: auto; /* ì›ë³¸ ë¹„ìœ¨ ìœ ì§€ */
      border-radius: 5px; /* ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
      pointer-events: all; /* ì´ë¯¸ì§€ í´ë¦­ ê°€ëŠ¥ */
      cursor: pointer; /* ë§ˆìš°ìŠ¤ ì»¤ì„œ í‘œì‹œ */
    }

    /* ë“œë˜ê·¸ ê°€ëŠ¥í•œ êµ¬ë¶„ì„  */
    .divider {
      width: 5px; /* êµ¬ë¶„ì„  ë„ˆë¹„ */
      background: #ccc; /* êµ¬ë¶„ì„  ìƒ‰ìƒ */
      cursor: ew-resize; /* ë§ˆìš°ìŠ¤ ì»¤ì„œ: ì¢Œìš° í™”ì‚´í‘œ */
    }

    /* ì˜¤ë¥¸ìª½ í˜ì´ì§€ (í…ìŠ¤íŠ¸ í‘œì‹œ ì˜ì—­) */
    .right-page {
      display: flex; /* í…ìŠ¤íŠ¸ ì •ë ¬ */
      flex-direction: column; /* ìˆ˜ì§ ì •ë ¬ */
      justify-content: center; /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
      align-items: center; /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
      background: #fff; /* í˜ì´ì§€ ë°°ê²½ ìƒ‰ìƒ */
      width: auto; /* ë„ˆë¹„ ìë™ ì¡°ì • */
      overflow: hidden; /* ë„˜ì¹˜ëŠ” í…ìŠ¤íŠ¸ ìˆ¨ê¹€ */
      padding: 20px; /* ì—¬ë°± */
    }

    /* ì˜¤ë¥¸ìª½ í˜ì´ì§€ì˜ í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
    .right-page p {
      margin: 0; /* ê¸°ë³¸ ì—¬ë°± ì œê±° */
      font-size: 1.5vw; /* í…ìŠ¤íŠ¸ í¬ê¸° */
      text-align: center; /* í…ìŠ¤íŠ¸ ì¤‘ì•™ ì •ë ¬ */
    }

    /* ìŠ¤í”¼ì»¤ ë²„íŠ¼ (ì˜¤ë””ì˜¤ ë²„íŠ¼) */
    .audio-button {
    position: absolute; /* ê³ ì • ìœ„ì¹˜ */
    top: 20px; /* ìœ„ìª½ ì—¬ë°± */
    right: 20px; /* ì˜¤ë¥¸ìª½ ì—¬ë°± */
    padding: 10px; /* ë²„íŠ¼ ë‚´ë¶€ ì—¬ë°± */
    z-index: 10; /* í…ìŠ¤íŠ¸ ìœ„ë¡œ í‘œì‹œ */
    font-size: 20px; /* ì•„ì´ì½˜ í¬ê¸° */
    width: 50px; /* ë²„íŠ¼ í¬ê¸° */
    height: 50px; /* ë²„íŠ¼ í¬ê¸° */
    border-radius: 50%; /* ì›í˜• ë²„íŠ¼ */
    background: #f5f5f5; /* ë²„íŠ¼ ë°°ê²½ */
    border: 1px solid #ccc; /* í…Œë‘ë¦¬ */
    display: flex; /* ì¤‘ì•™ ì •ë ¬ */
    justify-content: center; /* ì•„ì´ì½˜ ìˆ˜í‰ ì •ë ¬ */
    align-items: center; /* ì•„ì´ì½˜ ìˆ˜ì§ ì •ë ¬ */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* ê·¸ë¦¼ì íš¨ê³¼ */
    cursor: pointer; /* í´ë¦­ ê°€ëŠ¥í•œ ë§ˆìš°ìŠ¤ ì»¤ì„œ */
    transition: transform 0.01s ease; /* í˜¸ë²„ ë° í´ë¦­ íš¨ê³¼ */
    }

    /* ì¬ìƒ ì¤‘ì¼ ë•Œ ë™ê·¸ë€ ë°°ê²½ ì• ë‹ˆë©”ì´ì…˜ */
    .audio-playing {
    animation: pulse 1.5s infinite; /* ì• ë‹ˆë©”ì´ì…˜ ì„¤ì • */
    }

    @keyframes pulse {
    0%, 100% {
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.3); /* ê¸°ë³¸ ìƒíƒœ */
        transform: scale(0.95); /* ê¸°ë³¸ í¬ê¸° */
    }
    50% {
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.5); /* í™•ì¥ëœ ìƒíƒœ */
        transform: scale(1.05); /* í¬ê¸° í™•ëŒ€ */
    }
    }
    
    /* ì¬ìƒ ì œì–´ ë²„íŠ¼ */
    .control-buttons {
      position: absolute;
      top: 20px;
      right: 20px;
      display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
      flex-direction: column;
      gap: 10px;
    }

    /* ì¬ìƒ ì œì–´ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .control-buttons button {
    font-size: 20px; /* ì•„ì´ì½˜ í¬ê¸° */
    width: 50px; /* ë²„íŠ¼ í¬ê¸° */
    height: 50px; /* ë²„íŠ¼ í¬ê¸° */
    border-radius: 50%; /* ì›í˜• ë²„íŠ¼ */
    background: #f5f5f5; /* ë²„íŠ¼ ë°°ê²½ */
    border: 1px solid #ccc; /* í…Œë‘ë¦¬ */
    display: flex; /* ì¤‘ì•™ ì •ë ¬ */
    justify-content: center; /* ì•„ì´ì½˜ ìˆ˜í‰ ì •ë ¬ */
    align-items: center; /* ì•„ì´ì½˜ ìˆ˜ì§ ì •ë ¬ */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* ê·¸ë¦¼ì íš¨ê³¼ */
    cursor: pointer; /* í´ë¦­ ê°€ëŠ¥í•œ ë§ˆìš°ìŠ¤ ì»¤ì„œ */
    transition: transform 0.01s ease; /* í˜¸ë²„ ë° í´ë¦­ íš¨ê³¼ */
    }

    .audio-button:hover,.control-buttons button:hover {
    color: #ddd; /* í˜¸ë²„ ì‹œ ì•„ì´ì½˜ ìƒ‰ìƒ */
    }

    .audio-button:active, .control-buttons button:active {
    transform: scale(0.9); /* í´ë¦­ ì‹œ ì‚´ì§ ì¶•ì†Œ */
    }

    /* í˜ì´ì§€ ì´ë™ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ */
    .page-buttons {
      position: absolute; /* ê³ ì • ìœ„ì¹˜ */
      bottom: 10px; /* ì•„ë˜ìª½ ì—¬ë°± */
      width: 100%; /* ë²„íŠ¼ì´ í˜ì´ì§€ ì „ì²´ë¥¼ ì°¨ì§€ */
      display: flex; /* ë²„íŠ¼ì„ ê°€ë¡œë¡œ ì •ë ¬ */
      justify-content: space-between; /* ì¢Œìš° ë²„íŠ¼ ë¶„ë¦¬ */
    }

    /* í˜ì´ì§€ ì´ë™ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .page-buttons button {
      background: #ccc; /* ë²„íŠ¼ ë°°ê²½ */
      border: none; /* í…Œë‘ë¦¬ ì—†ìŒ */
      padding: 10px 20px; /* ë²„íŠ¼ í¬ê¸° */
      border-radius: 5px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
      cursor: pointer; /* í´ë¦­ ê°€ëŠ¥í•œ ë§ˆìš°ìŠ¤ ì»¤ì„œ */
      font-size: 16px; /* ê¸€ê¼´ í¬ê¸° */
      transition: all 0.2s ease; /* ìƒ‰ìƒ ë³€ê²½ íš¨ê³¼ */
    }

    /* ë²„íŠ¼ í˜¸ë²„ íš¨ê³¼ */
    .page-buttons button:hover {
      background: #999; /* í˜¸ë²„ ì‹œ ìƒ‰ìƒ ë³€ê²½ */
    }

    /* ì´ë¯¸ì§€ í™•ëŒ€ ëª¨ë‹¬ */
    .modal {
      position: fixed; /* í™”ë©´ì— ê³ ì • */
      top: 0; /* ìœ„ìª½ ì—¬ë°± ì—†ìŒ */
      left: 0; /* ì™¼ìª½ ì—¬ë°± ì—†ìŒ */
      width: 100%; /* ì „ì²´ í™”ë©´ ë„ˆë¹„ */
      height: 100%; /* ì „ì²´ í™”ë©´ ë†’ì´ */
      display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
      justify-content: center; /* ì¤‘ì•™ ì •ë ¬ */
      align-items: center; /* ì¤‘ì•™ ì •ë ¬ */
      background: rgba(0, 0, 0, 0.8); /* ì–´ë‘ìš´ ë°˜íˆ¬ëª… ë°°ê²½ */
      backdrop-filter: blur(5px); /* ë°°ê²½ ë¸”ëŸ¬ íš¨ê³¼ */
      z-index: 1000; /* ìœ„ë¡œ ì˜¬ë¦¬ê¸° */
    }

    /* ëª¨ë‹¬ ë‚´ë¶€ ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
    .modal img {
      max-width: 80%; /* ìµœëŒ€ ë„ˆë¹„ */
      max-height: 80%; /* ìµœëŒ€ ë†’ì´ */
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5); /* ê·¸ë¦¼ì íš¨ê³¼ */
    }

    /* ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ */
    .modal .download-button {
      position: absolute; /* ê³ ì • ìœ„ì¹˜ */
      bottom: 20px; /* ì•„ë˜ìª½ ì—¬ë°± */
      right: 20px; /* ì˜¤ë¥¸ìª½ ì—¬ë°± */
      background: #fff; /* ë²„íŠ¼ ë°°ê²½ */
      padding: 10px 20px; /* ë²„íŠ¼ ë‚´ë¶€ ì—¬ë°± */
      border-radius: 5px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
      font-size: 16px; /* í…ìŠ¤íŠ¸ í¬ê¸° */
      text-decoration: none; /* ë°‘ì¤„ ì œê±° */
      color: #333; /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3); /* ê·¸ë¦¼ì íš¨ê³¼ */
      cursor: pointer; /* í´ë¦­ ê°€ëŠ¥í•œ ë§ˆìš°ìŠ¤ ì»¤ì„œ */
    }

    /* ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ í˜¸ë²„ íš¨ê³¼ */
    .modal .download-button:hover {
      background: #f0f0f0; /* í˜¸ë²„ ì‹œ ë°ì€ ë°°ê²½ */
    }

    /* ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼ */
    .modal .close {
      position: absolute; /* ê³ ì • ìœ„ì¹˜ */
      top: 20px; /* ìœ„ìª½ ì—¬ë°± */
      right: 20px; /* ì˜¤ë¥¸ìª½ ì—¬ë°± */
      font-size: 24px; /* ë‹«ê¸° ë²„íŠ¼ í¬ê¸° */
      color: white; /* ë‹«ê¸° ë²„íŠ¼ ìƒ‰ìƒ */
      cursor: pointer; /* í´ë¦­ ê°€ëŠ¥í•œ ë§ˆìš°ìŠ¤ ì»¤ì„œ */
    }
  </style>
</head>
<body>
  <div class="book">
    <div class="page">
      <div class="left-page">
        <!-- ì´ë¯¸ì§€ í´ë¦­ ì‹œ openModal() í˜¸ì¶œ -->
        <img id="page-image" src="{{ pages.0.image }}" alt="ë™í™” ì´ë¯¸ì§€" onclick="openModal()">
      </div>
      <div class="divider" onmousedown="startResizing(event)"></div>
      <div class="right-page">
        <p id="page-text"></p>
      </div>
    </div>

    <div class="page-buttons">
      <button id="prev-button" onclick="prevPage()">â—€ ì´ì „ í˜ì´ì§€</button>
      <button id="next-button" onclick="nextPage()">ë‹¤ìŒ í˜ì´ì§€ â–¶</button>
    </div>

    <button class="audio-button" id="audioButton" onclick="toggleAudio()">ğŸ•ª</button>

    <div class="control-buttons" id="controlButtons">
      <button onclick="resumeAudio()">â¯ï¸</button>
      <button onclick="restartAudio()">ğŸ—˜</button>
    </div>
  </div>

  <!-- ëª¨ë‹¬ ì´ë¯¸ì§€ì˜ idë¥¼ modal-imageë¡œ ë³€ê²½ -->
  <div class="modal" id="modal">
    <span class="close" onclick="closeModal()">Ã—</span>
    <!-- ëª¨ë‹¬ìš© ì´ë¯¸ì§€ -->
    <img id="modal-image" src="{{ pages.0.image }}" alt="í™•ëŒ€ëœ ë™í™” ì´ë¯¸ì§€">
    <a id="download-link" href="{{ pages.0.image }}" download="{{ pages.0.image }}" class="download-button">ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ</a>
  </div>

  <audio id="page-audio" src="{{ pages.0.audio }}"></audio>

  <script>
    let isResizing = false;
    const minWidth = 100; 
    const dividerWidth = 5; 
    const minFontSize = 1; 
    const maxFontSize = 3; 

    const audio = document.getElementById("page-audio");
    const audioButton = document.getElementById("audioButton");
    const controlButtons = document.getElementById("controlButtons");
    let isPlaying = false; 

    const pages = {{ pages|safe }};
    let currentPage = 0;

    function updatePage() {
      const pageData = pages[currentPage];
      document.getElementById('page-text').textContent = pageData.text;
      document.getElementById('page-image').src = pageData.image;
      document.getElementById('page-audio').src = pageData.audio;

      document.getElementById('prev-button').disabled = currentPage === 0;
      document.getElementById('next-button').disabled = currentPage === pages.length - 1;
    }

    function prevPage() {
      if (currentPage > 0) {
        currentPage--;
        updatePage();
      }
    }

    function nextPage() {
      if (currentPage < pages.length - 1) {
        currentPage++;
        updatePage();
      }
    }

    updatePage();

    // ëª¨ë‹¬ ì—´ ë•Œ í˜„ì¬ í˜ì´ì§€ ì´ë¯¸ì§€ë¡œ ëª¨ë‹¬ ì—…ë°ì´íŠ¸
    function openModal() {
      const modal = document.getElementById('modal');
      const modalImage = document.getElementById('modal-image');
      const downloadLink = document.getElementById('download-link');

      // í˜„ì¬ í˜ì´ì§€ ì´ë¯¸ì§€ ì •ë³´ë¥¼ ê°€ì ¸ì™€ ì„¤ì •
      const currentImage = pages[currentPage].image;
      modalImage.src = currentImage;
      downloadLink.href = currentImage;
      downloadLink.download = currentImage.substring(currentImage.lastIndexOf('/')+1); 
      // ìœ„ì—ì„œ download ì†ì„±ì€ ì´ë¯¸ì§€ íŒŒì¼ëª…ë§Œ ì¶”ì¶œ (URLì—ì„œ ë§ˆì§€ë§‰ / ì´í›„ ë¶€ë¶„)

      modal.style.display = 'flex';
    }

    function closeModal() {
      const modal = document.getElementById('modal');
      modal.style.display = 'none';
    }

    function toggleAudio() {
      if (isPlaying) {
        audio.pause();
        isPlaying = false;
        audioButton.innerHTML = "ğŸ•ª";
        audioButton.classList.remove("audio-playing");
        audioButton.style.display = "none";
        controlButtons.style.display = "flex";
      } else {
        audio.play();
        isPlaying = true;
        audioButton.innerHTML = "â¯ï¸";
        audioButton.classList.add("audio-playing");
      }
    }

    function resumeAudio() {
      audio.play();
      isPlaying = true;
      controlButtons.style.display = "none";
      audioButton.style.display = "block";
      audioButton.innerHTML = "â¯ï¸";
      audioButton.classList.add("audio-playing");
    }

    function restartAudio() {
      audio.currentTime = 0;
      audio.play();
      isPlaying = true;
      controlButtons.style.display = "none";
      audioButton.style.display = "block";
      audioButton.innerHTML = "â¯ï¸";
      audioButton.classList.add("audio-playing");
    }

    audio.addEventListener("ended", () => {
      isPlaying = false;
      audioButton.innerHTML = "ğŸ•ª"; 
      audioButton.classList.remove("audio-playing");
    });

    function startResizing(event) {
      isResizing = true;
      document.addEventListener("mousemove", resize);
      document.addEventListener("mouseup", stopResizing);
      event.preventDefault();
    }

    function resize(event) {
      if (!isResizing) return;

      const book = document.querySelector(".book");
      const leftPage = document.querySelector(".left-page");
      const rightPage = document.querySelector(".right-page");
      const textContent = document.getElementById("page-text");

      const bookRect = book.getBoundingClientRect();
      const offsetX = event.clientX - bookRect.left; 

      const leftWidth = Math.max(minWidth, Math.min(offsetX, bookRect.width - minWidth - dividerWidth));
      leftPage.style.width = `${leftWidth}px`;

      rightPage.style.width = `${bookRect.width - leftWidth - dividerWidth}px`;

      const fontSize = Math.max(
        minFontSize,
        Math.min(maxFontSize, (rightPage.offsetWidth / bookRect.width) * maxFontSize)
      );
      textContent.style.fontSize = `${fontSize}vw`;
    }

    function stopResizing() {
      isResizing = false;
      document.removeEventListener("mousemove", resize);
      document.removeEventListener("mouseup", stopResizing);
    }
  </script>
</body>
</html>
